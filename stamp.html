<!DOCTYPE HTML>
<html>
  <head>
	<title>Baby Stamps</title>
	<style>
		body {
			margin: 0px;
			padding: 0px;
		}
		#available-icons span {
			width:100px;
			height: 100px;
			border:5px solid white;
			display:inline-block;
		}
		#available-icons .selected {
			border:5px solid blue;
		}
		#canvas {
			border:1px solid silver;
		}
	</style>
  </head>
  <body>
	<canvas id="main-canvas">
	</canvas>
	<div id="available-icons">
	</div>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script>
		(function($) {
			// set up the console logger
			if(!console){
				window.console = {};
			}
			if(!console.log){
				window.console.log = function(){};
			}
			
			// Manage the available images
			var imageManager = null;
			function ImageManager(data) {
				console.log("Loading image manager");
				this.images = {};
				this.categories = data.categories;
				this.images = data.images
				
				// Sets the category, will update the available images
				this.setCategory = function(category){
					console.log("Setting category to: " + category);
					$('#available-icons').html('');
					for(var i=0;i < data.images[category].length; i++){
						var img = data.images[category][i];
						$('#available-icons').append('<span><img src="'+img.src+'" alt="' + img.title + '" /></span>');
					}
				};

				this.setCategory(data.categories[0].name);
			}

			//Load the image JSON Data
			$.getJSON('stamps.json', function(data){
				console.log("Loading the available stamps");
				imageManager = new ImageManager(data);
			});
			
			var canvas = document.getElementById('main-canvas');
			var context = canvas.getContext('2d');
			
			//handle clicks
			$(document).click(function(event){
				try{
					var imgObj = $('#available-icons .selected img')[0];
					context.drawImage(imgObj, event.pageX - 50, event.pageY - 50);
				}catch(e){
					console.log('Exception loading image: '+e.message);
				}
			});
		})(jQuery);
		
	</script>
	
  </body>
</html>