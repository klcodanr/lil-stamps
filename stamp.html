<!DOCTYPE HTML>
<html>
  <head>
	<title>Baby Stamps</title>
	<style>
		body {
			margin: 0px;
			padding: 0px;
		}
		#available-icons span {
			width:100px;
			height: 100px;
			border:5px solid white;
			display:inline-block;
		}
		#available-icons .selected {
			border:5px solid blue;
		}
		canvas{
			border:1px solid silver;
		}
	</style>
  </head>
  <body>
	<div id="container"></div>
	<div id="available-icons">
	</div>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.0-beta2.js"></script>
	<script>
		(function($) {
			
			$.getJSON('stamps.json', function(data){
				var defaultCategory = data.categories[0].name;
				for(var i=0;i < data.images[defaultCategory].length; i++){
					$('#available-icons').append('<span><img src="'+data.images[defaultCategory][i].src+'" /></span>');
				}

				// handle image selection
				$('#available-icons span').click(function(){
					$('#available-icons span').removeClass('selected');
					$(this).addClass('selected');
				});
			});
			
			

			//create the stage
			var stage = new Kinetic.Stage({
				container: 'container',
				width: $(document).width(),
				height: $(document).height() - 100
			});
			
			$(document).click(function(event){
				try{
					var layer = new Kinetic.Layer();
					var imageObj = new Image();
					imageObj.onload = function() {
						var img = new Kinetic.Image({
							x: event.pageX,
							y: event.pageY,
							image: imageObj,
							width: 100,
							height: 100
						});
						layer.add(img);
						stage.add(layer);
					};
					var imgSrc = $('#available-icons .selected img').attr('src');
					imageObj.src = imgSrc;
				}catch(e){
					console.log('Exception loading image: '+e.message);
				}
			});
		})(jQuery);
		
	</script>
	
  </body>
</html>